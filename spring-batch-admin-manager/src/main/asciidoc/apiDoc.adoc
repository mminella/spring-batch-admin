= Spring Batch Admin REST API Guide
Michael T Minella;
:doctype: book
:toc:
:sectanchors:
:sectlinks:
:toclevels: 4
:source-highlighter: highlightjs

[[overview]]
= Overview

[[overview-hypermedia]]
== Hypermedia

Spring Batch Admin uses hypermedia and resources include links to other resources in their
responses. Responses are in http://stateless.co/hal_specification.html[Hypertext Application
Language (HAL)] format. Links can be found benath the `links` key. Users of the API should
not created URIs themselves, instead they should use the above-described links to navigate
from resource to resource.

[[overview-pagination]]
== Pagination

Spring Batch Admin utilizes Spring Data's pagination facilities for consistent pagination
support.  Below outlines normal request and response semantics for paginated resources

[[overview-pagination-request]]
=== Pagination Query parameters

|===
|Parameter|Description

|page
|Requested page index (0 based)

|size
|Number of elements per page

|===

[[overview-pagination-response]]
=== Pagination Response fields

Each paginated resource will contain a `page` object that contains the following:

|===
|field|Type|Description

|size
|int
|Number of elements in this page

|totalElements
|int
|Number of elements in the entire collection (if it wasn't paginated)

|totalPages
|int
|Number of pages within the total number of elements

|number
|int
|The page number the response represents

|===



[[resources]]
= Resources

[[file]]
== Files
The Files service provides the ability to upload data files as well as Spring Batch
configuration

[[file-resource]]
=== File

|===
|field|Type|Description

|timestamp
|String
|timestamp for the creation of the file

|path
|String
|the path to the file

|shortPath
|String
|abbreviated path to the file

|local
|boolean
|indicates if the file is local to the application

|deleteCount
|int
|number of files that have been deleted

|links
|array of URLs
|link to the specific file resource

|===


[[accessing-files]]
=== Accessing the file list

A `GET` request is used to access the list of files

==== Query parameters

include::{snippets}/file-list/query-parameters.adoc[]

==== Example request

include::{snippets}/file-list/curl-request.adoc[]

==== Response structure

include::{snippets}/file-list/response-fields.adoc[]

==== Example Response

include::{snippets}/file-list/http-response.adoc[]

[[deleting-files]]
=== Deleting files

A `DELETE` request is used to delete files

==== Query parameters

include::{snippets}/file-delete/query-parameters.adoc[]

==== Example request

The request takes a single path parameter `pattern` that specifies the pattern describing
the files to be deleted

include::{snippets}/file-delete/curl-request.adoc[]

==== Response structure

include::{snippets}/file-delete/response-fields.adoc[]

==== Example Response

include::{snippets}/file-delete/http-response.adoc[]

[[file-upload-request]]
=== Uploading a file

A `POST` request is used to upload a file

==== Query parameters

include::{snippets}/file-upload-request/query-parameters.adoc[]

==== Example request

include::{snippets}/file-upload-request/curl-request.adoc[]

==== Response structure

include::{snippets}/file-upload-request/response-fields.adoc[]

==== Example Response

include::{snippets}/file-upload-request/http-response.adoc[]


[[job-execution]]
== JobExecutions
The JobExecutions service provides access to the same information located in the job
repository related to job executions.  It also provides facilities for starting,
restarting, and stopping jobs.

[[job-execution-resource]]
=== JobExecution

|===
|field|Type|Description

|executionId
|long
|id of the `JobExecution`

|stepExecutionCount
|int
|number of step executions for this job execution

|jobId
|long
|id of the `JobInstance`

|version
|Long
|used for optimistic locking

|startTime
|Date
|date/time the job execution was started

|endTime
|Date
|date/time the job execution completed if it has completed at all

|createDate
|Date
|date/time the job execution was created

|lastUpdated
|Date
|date/time the last update for this job execution

|jobParameters
|Object
|Map of key (parameter name) and value (<<job-parameter>>)

|restartable
|boolean
|indicates if this job execution is restartable

|abandonable
|boolean
|indicates if this job execution is able to be abandoned

|stoppable
|boolean
|indicates if this job execution can be stopped as of the time checked

|timeZone
|String
|the configured time zone

|status
|String
|`BatchStatus` for this job execution

|exitStatus
|Object
|<<exit-status>>

|jobConfigurationName
|String
|the name of the configuration file used to launch the job (used in JSR-352 jobs only)

|failureExceptions
|array of exceptions
|the causes for the failure of this job execution

|executionContext
|Object
|A map of values that have been stored in the job execution's `ExecutionContext`

|stepExecutions
|array of <<step-execution-resource>>
|<<step-execution-resource>>

|name
|String
|the name of the job

|links
|array of links
|self is the link to this job execution

|===


[[job-parameter]]
=== JobParameter

The `JobParameters` object represents a map of keys (parameter name) and values
(`JobParameter` instance).  This section documents the `JobParameter` instance.

|===
|field|Type|Description

|identifying
|boolean
|indicates if the parameter contributes to the identity of a job instance

|value
|Object
|the value for the parameter

|type
|String
|indicates the type for the parameter value (int, string, etc)

|===


[[exit-status]]
=== ExitStatus

The `ExitStatus` represents the user defined result of a step or job.

|===
|field|Type|Description

|exitCode
|String
|resulting status of the job or step.  Matches the batch status of the corresponding
execution if not set by the user.

|exitDescription
|String
|description for the result.  Contains the stack trace for an error when the job fails and
the exception is handled by the framework.

|running
|boolean
|indicates if the execution is running or not.

|===


[[step-execution-resource]]
=== StepExecution

The `StepExecution` represents an execution of a step within the scope of a job.

|===
|field|Type|Description

|executionId
|long
|the id of the step execution

|jobExecutionId
|long
|the id of the <<job-execution-resource>> that the step is related to

|stepType
|String
|type of step (tasklet step, flow step, etc).  Possible values are defined by
`org.springframework.batch.admin.domain.StepType`

|stepName
|String
|name of the step

|status
|String
|`BatchStatus` for this step execution

|readCount
|int
|number of items that have been read during this step execution

|writeCount
|int
|number of items that have been written during this step execution

|commitCount
|int
|number of transaction commits that have occurred during this step execution

|rollbackCount
|int
|number of rollbacks that have occurred during this step execution

|readSkipCount
|int
|number of exceptions in the read that have been skipped

|processSkipCount
|int
|number of exceptions in the processor that have been skipped

|writeSkipCount
|int
|number of exceptions in the write that have been skipped

|startTime
|Date
|date/time the step execution was started

|endTime
|Date
|date/time the step execution completed if it has completed at all

|lastUpdated
|Date
|date/time the last update for this step execution

|executionContext
|Object
|A map of values that have been stored in the step execution's `ExecutionContext`

|exitStatus
|Object
|<<exit-status>>

|terminateOnly
|boolean
|true if the step has been requested to stop

|filterCount
|int
|count of items that were filtered via the `ItemProcessor`

|failureExceptions
|array of exceptions
|list of exceptions that caused the step to fail

|version
|Long
|used for optimistic locking

|links
|array of links
|self is the link to this step execution

|===


[[accessing-job-executions]]
=== Accessing job executions in a paginated way

A `GET` request is used to access a page of job executions

==== Query parameters

include::{snippets}/job-executions-list/query-parameters.adoc[]

==== Example request

include::{snippets}/job-executions-list/curl-request.adoc[]

==== Response structure

include::{snippets}/job-executions-list/response-fields.adoc[]

==== Example Response

include::{snippets}/job-executions-list/http-response.adoc[]

[[accessing-job-execution]]
=== Accessing job executions for a specific job in a paginated way

A `GET` request is used to access a page of job executions

==== Query parameters

include::{snippets}/job-executions-by-name/query-parameters.adoc[]

==== Example request

include::{snippets}/job-executions-by-name/curl-request.adoc[]

==== Response structure

include::{snippets}/job-executions-by-name/response-fields.adoc[]

==== Example Response

include::{snippets}/job-executions-by-name/http-response.adoc[]

[[accessing-job-execution-by-instance]]
=== Accessing job executions for a specific job instance

A `GET` request is used to access the job executions

==== Query parameters

include::{snippets}/job-executions-by-instance-id/query-parameters.adoc[]

==== Example request

include::{snippets}/job-executions-by-instance-id/curl-request.adoc[]

==== Response structure

include::{snippets}/job-executions-by-instance-id/response-fields.adoc[]

==== Example Response

include::{snippets}/job-executions-by-instance-id/http-response.adoc[]


[[stop-all-jobs]]
=== Stopping all running jobs

A `PUT` request with `stop=true`

==== Query parameters

include::{snippets}/stop-all-jobs/query-parameters.adoc[]

==== Example request

include::{snippets}/stop-all-jobs/curl-request.adoc[]

==== Response structure

include::{snippets}/stop-all-jobs/response-fields.adoc[]

==== Example Response

include::{snippets}/stop-all-jobs/http-response.adoc[]


[[job-instance]]
== JobInstances
The JobInstances service provides access to the same information located in the job
repository related to job instances.

[[job-instance-resource]]
=== JobInstance

|===
|field|Type|Description

|jobName
|String
|name of the job

|instanceId
|long
|id of the job instance

|executions
|array of <<job-execution-resource>>
|<<job-execution-resource>>

|links
|array of links
|self is the link to this job instance

|===


[[job-instances-for-job]]
=== Get job instances for a job

A `GET` request for all the job instances for the requested job name

==== Query parameters

include::{snippets}/instances-for-job/query-parameters.adoc[]

==== Example request

include::{snippets}/instances-for-job/curl-request.adoc[]

==== Response structure

include::{snippets}/instances-for-job/response-fields.adoc[]

==== Example Response

include::{snippets}/instances-for-job/http-response.adoc[]


[[job-detail]]
== Jobs
The Jobs service provides access to information about jobs known to this instance of
Spring Batch Admin

[[job-detail-resource]]
=== JobDetail

|===
|field|Type|Description

|name
|String
|name of the job

|executionCount
|int
|number of job executions for this job

|launchable
|boolean
|true if the job is able to be launched

|incrementable
|boolean
|true if a run incrementer is configured

|jobInstanceId
|long
|id of the job instance

|jobParameters
|Object
|Map of key (parameter name) and value (<<job-parameter>>)

|startTime
|Date
|date/time the step execution was started

|endTime
|Date
|date/time the step execution completed if it has completed at all

|stepExecutionCount
|int
|number of steps executed within the execution

|exitStatus
|Object
|<<exit-status>>

|links
|array of links
|self is the link to this step execution

|===


[[list-jobs]]
=== Get a page of jobs

A `GET` request for a page of job definitions

==== Query parameters

include::{snippets}/jobs/query-parameters.adoc[]

==== Example request

include::{snippets}/jobs/curl-request.adoc[]

==== Response structure

include::{snippets}/jobs/response-fields.adoc[]

==== Example Response

include::{snippets}/jobs/http-response.adoc[]


[[step]]
== Step
The Step service provides the ability to query the job repository about previously
executed step executions.

[[step-progress-resource]]
=== Step Execution Progress
This resource extends <<step-execution-resource>>.  Only the additional fields are
documented below.

|===
|field|Type|Description

|percentageComplete
|double
|percentage complete based on historical durations

|finished
|boolean
|true if the step execution is complete

|duration
|double
|duration of the step

|stepExecutionHistory
|StepExecutionHistory
|A <<step-execution-history>>

|===


[[step-execution-history]]
=== Step Execution History
This resource represents historical data on the step.

|===
|field|Type|Description

|stepName
|String
|name of the step

|count
|int
|number of times the step has been executed

|commitCount
|CumulativeHistory
|the history of the `commitCount` metric for this step

|rollbackCount
|CumulativeHistory
|the history of the `rollbackCount` metric for this step

|readCount
|CumulativeHistory
|the history of the `readCount` metric for this step

|writeCount
|CumulativeHistory
|the history of the `writeCount` metric for this step

|filterCount
|CumulativeHistory
|the history of the `filterCount` metric for this step

|readSkipCount
|CumulativeHistory
|the history of the `readSkipCount` metric for this step

|writeSkipCount
|CumulativeHistory
|the history of the `writeSkipCount` metric for this step

|processSkipCount
|CumulativeHistory
|the history of the `processSkipCount` metric for this step

|duration
|CumulativeHistory
|the history of the `duration` metric for this step

|durationPerRead
|CumulativeHistory
|the history of the `durationPerRead` metric for this step

|===


[[cumulative-history]]
=== CumulativeHistory
A representation of standard statistical values for a given metric

|===
|field|Type|Description

|count
|int
|number of times the event occurred

|mean
|double
|The mean of the metric's value

|standardDeviation
|double
|the standard deviation of the metric's value

|max
|double
|the max value observed for the metric

|min
|double
|the min value observed for the metric
|===


[[list-steps]]
=== Accessing the list of steps for a job execution

A `GET` request is used to access the list of steps

==== Query parameters

include::{snippets}/step-executions-list/path-parameters.adoc[]

==== Example request

include::{snippets}/step-executions-list/curl-request.adoc[]

==== Response structure

include::{snippets}/step-executions-list/response-fields.adoc[]

==== Example Response

include::{snippets}/step-executions-list/http-response.adoc[]


[[details-steps]]
=== Accessing a specific step execution

A `GET` request is used to access the step execution

==== Query parameters

include::{snippets}/step-executions-details/path-parameters.adoc[]

==== Example request

include::{snippets}/step-executions-details/curl-request.adoc[]

==== Response structure

include::{snippets}/step-executions-details/response-fields.adoc[]

==== Example Response

include::{snippets}/step-executions-details/http-response.adoc[]



[[progress-steps]]
=== Accessing the progress of a step execution

A `GET` request is used to the progress

==== Query parameters

include::{snippets}/step-execution-progress/path-parameters.adoc[]

==== Example request

include::{snippets}/step-execution-progress/curl-request.adoc[]

==== Response structure

include::{snippets}/step-execution-progress/response-fields.adoc[]

==== Example Response

include::{snippets}/step-execution-progress/http-response.adoc[]




